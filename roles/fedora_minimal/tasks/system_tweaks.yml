---
# tweaks
#

- name: Update fstab file with tmpfs /tmp
  lineinfile:
    path: /etc/fstab
    regexp: tmpfs /tmp tmpfs
    line: tmpfs /tmp tmpfs defaults,lazytime,noatime,nodiratime 0 0
    state: present
    backup: yes
  become: yes

- name: Discard Trim Enable
  systemd:
    name: fstrim.timer
    state: started
    enabled: yes
    daemon_reload: yes
  become: yes

- name: Load IO Schedulers at boot
  blockinfile:
    path: /etc/modules-load.d/iosched.conf
    create: yes
    block: |
      bfq
      mq-deadline
      kyber-iosched
  become: yes

- name: Improve DNF Performances
  blockinfile:
    path: /etc/dnf/dnf.conf
    create: yes
    block: |
      deltarpm=true
      fastestmirror=true
      max_parallel_downloads={{ ansible_processor_vcpus }}
  become: yes

...
